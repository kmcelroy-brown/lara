= nested_form_for @embeddable do |f|
  = f.error_messages
  = field_set_tag 'Heading' do
    = f.text_field :name
  = field_set_tag 'Prompt' do
    = f.text_area :prompt, :rows => 5
    :javascript
      $(function() {
          $('#embeddable_multiple_choice_prompt').wysiwyg({"controls": { "html": { "visible": true }, "h1": { "visible": false }, "h2": { "visible": false }, "h3": { "visible": false } } });
      });
  = field_set_tag 'Choices' do
    .choices
      %ul
        - @embeddable.choices.each do |choice|
          = f.fields_for :choices, choice do |choice_form|
            %li
              Choice:
              = choice_form.text_field :choice
              Correct:
              = choice_form.check_box :is_correct
              = choice_form.link_to_remove "Delete"
            %li.custom-hidden{ :style => @embeddable.custom ? '' : 'display: none;' }
              Message:
              = choice_form.text_field :prompt
      = f.link_to_add "Add choice", :choices
    %label
      = f.check_box :multi_answer
      Allow multiple answers?
    %br
    %label
      = f.check_box :require_rationale
      Require user to provide rationale for answers?
    %br
    %label
      = f.check_box :enable_check_answer
      Allow users to use the "Check Answer" button?
    %br
    %label
      -# TODO: This should be unobtrusive JS and not onclick
      = f.check_box :custom, :onclick => "showPrompts();"
      Provide custom feedback using "Check Answer"?
  = f.submit "Cancel", :class => 'close'
  = f.submit "Save", :class => 'embeddable-save'
